"use strict";(self.webpackChunkgomrok24=self.webpackChunkgomrok24||[]).push([[283],{62283:(e,t,s)=>{s.r(t),s.d(t,{default:()=>f});var o=s(8869),a=s(75590),r=s(2135),i=s(58467),l=s(71640),n=s(47313),d=s(82036),h=s(85281),c=s(61708),m=s(23148),u=s(66978),p=s(46417);const x=120;class v extends n.Component{constructor(e){var t,s,o;super(e),t=this,this.handleSendCodeAgain=e=>{this.handleRegister=e},this.handleRegister=e=>{e.preventDefault();let t=this.state.countryCode||"98",s=this.state.phoneNumber||"0";this.state.captcha;if(!s||""==s||0==s)return void(0,d.Am)("\u0644\u0637\u0641\u0627 \u0634\u0645\u0627\u0631\u0647 \u0645\u0648\u0628\u0627\u06cc\u0644 \u062e\u0648\u062f \u0631\u0627 \u0648\u0627\u0631\u062f \u06a9\u0646\u06cc\u062f",{type:"error"});s=s.substring(s.length-10),this.setState({thePhoneNumber:s,countryCode:t,phoneNumber:s});let o=t+(0,u.dv)(s);(0,c.z2)(o,t,this.state.loginMethod).then((e=>{e.shallWeSetPass?(this.state.timer=x,this.myInterval=setInterval((()=>{this.setState((e=>{let{timer:t}=e;return{timer:t>0?t-1:this.handleClearInterval()}}))}),1e3),this.setState({enterActivationCodeMode:!0,activationCode:null,isDisplay:!1,userWasInDbBefore:null===e||void 0===e?void 0:e.userWasInDbBefore})):!e.shallWeSetPass&&e.userWasInDbBefore&&this.setState({isDisplay:!1,getPassword:!0,userWasInDbBefore:null===e||void 0===e?void 0:e.userWasInDbBefore})}))},this.handleClearInterval=()=>(clearInterval(this.myInterval),0),this.handlePassword=e=>{e.preventDefault();let t=(this.state.countryCode||"98")+this.state.phoneNumber;(0,c.di)({phoneNumber:t,password:this.state.password}).then((e=>{e.success?this.props&&this.props.goToCheckout?this.setState({token:e.customer.token,firstName:e.customer&&e.customer.firstName?e.customer.firstName:null,lastName:e.customer&&e.customer.lastName?e.customer.lastName:null,goToCheckout:!0}):this.setState({token:e.customer.token,goToProfile:!0}):e.message&&alert(e.message)})).catch((e=>{(0,d.Am)(this.props.t(e.message),{type:"error"})}))},this.handleForgotPass=e=>{e.preventDefault();let t=this.state.countryCode||"98",s=this.state.phoneNumber||"0",o=t+(0,u.dv)(s);(0,c.gM)(o,t,this.state.loginMethod).then((e=>{this.setState({enterActivationCodeMode:!0,isDisplay:!1,getPassword:!1,firstName:e.firstName,lastName:e.lastName}),this.state.timer=x,this.myInterval=setInterval((()=>{this.setState((e=>{let{timer:t}=e;return{timer:t>0?t-1:this.handleClearInterval()}}))}),1e3)}))},this.handleWrongPhoneNumber=e=>{this.handleClearInterval(),e.preventDefault(),this.setState({phoneNumber:null,activationCode:null,enterActivationCodeMode:!1,showSecondForm:!1,isDisplay:!0,setPassword:!1,getPassword:!1,goToProfile:!1,timer:x})},this.savePasswordAndData=e=>{e.preventDefault();const{countryCode:t,phoneNumber:s,firstName:o,lastName:a,email:r,registerExtraFields:i,userWasInDbBefore:l,webSite:n,password:h,extraFields:m,internationalCode:u,internationalCodeClass:p,address:x,sessionId:v}=this.state,{t:g}=this.props;let f=x;f||(f=[]);let N=t||"98";if(o&&""!=o)if(a&&""!=a)if(!this.state.passwordAuthentication||h&&void 0!=h&&""!=h){if(i)for(let e=0;e<=(null===i||void 0===i?void 0:i.length);e++){var b,j;let t=null===(b=i[e])||void 0===b?void 0:b.name,s=null===(j=i[e])||void 0===j?void 0:j.require;if(s&&"address"==t){let e={StreetAddress:m[t]};m.PostalCode&&(e.PostalCode=m.PostalCode),m.postalCode&&(e.PostalCode=m.postalCode),m.postalcode&&(e.PostalCode=m.postalcode),f.push(e)}if(s&&"internationalCode"==t){if(!m[t]||void 0==m[t]||""==m[t])return void(0,d.Am)(g("fill internationalCode!"),{type:"error"});if(!p||void 0==p||""==p){if(!u)return void(0,d.Am)(g("fill internationalCode!"),{type:"error"});if(!(0,c.zu)(u))return void(0,d.Am)(g("fill internationalCode!"),{type:"error"})}}if(s&&"internationalCode"!==t&&"address"!==t&&(!m[t]||void 0==m[t]||""==m[t]))return void(0,d.Am)(g("fill every thing!"),{type:"error"})}C(o)?C(a)?null!==n&&void 0!==n&&n.title&&!l?(0,c.Y2)({webSite:n,sessionId:v}).then((e=>{e.success&&(e.message.error?d.Am.error(g("website already exist!")):(0,c.AD)({phoneNumber:N+s,firstName:o,lastName:a,webSite:n,address:f,email:r,data:m,internationalCode:u,password:h}).then((e=>{(e.success||e.customer.firstName&&e.customer.lastName&&e.customer.webSite)&&this.setState({setPassword:!1,goToSiteBuilder:!0})})))})):l&&(0,c.AD)({phoneNumber:N+s,firstName:o,lastName:a,address:f,email:r,data:m,internationalCode:u,password:h}).then((e=>{e.success&&this.setState({setPassword:!1,goToProfile:!0})})):(0,d.Am)(g("Enter last name in persian!"),{type:"error"}):(0,d.Am)(g("Enter first name in persian!"),{type:"error"})}else(0,d.Am)(g("fill everything!"),{type:"error"});else(0,d.Am)(g("fill everything!"),{type:"error"});else(0,d.Am)(g("fill everything!"),{type:"error"});function C(e){return!!/^[\u0600-\u06FF\s]+$/.test(e)}},this.handleActivation=e=>{e.preventDefault();let{activationCode:s,countryCode:o,phoneNumber:a="0"}=this.state,{t:r}=this.props;o||(o="98"),s||alert("enter activation code!");let i={activationCode:s,phoneNumber:o+(0,u.dv)(a)};(0,c.bB)(i).then((function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!e.success)return d.Am.error(r(e.message));if(e.success&&d.Am.success(r("welcome")),e.shallWeSetPass){let s={token:e.token,enterActivationCodeMode:!1,setPassword:!0,firstName:e.firstName,lastName:e.lastName};t.setState(s)}else t.state.userWasInDbBefore?t.setState({token:null===e||void 0===e?void 0:e.token,enterActivationCodeMode:!1,setPassword:!1,goToProfile:!0,firstName:null===e||void 0===e?void 0:e.firstName,lastName:null===e||void 0===e?void 0:e.lastName}):t.setState({token:null===e||void 0===e?void 0:e.token,enterActivationCodeMode:!1,setPassword:!0,firstName:null===e||void 0===e?void 0:e.firstName,webSite:null===e||void 0===e?void 0:e.webSite,lastName:null===e||void 0===e?void 0:e.lastName})}))};let a=m.ZP.getState().store,r=!1;!a.user.token||a.user.firstName&&a.user.lastName||(r=!0),this.state={captcha:!1,phoneNumber:null,sessionId:"",thePhoneNumber:null,activationCode:null,enterActivationCodeMode:!1,showSecondForm:!1,userWasInDbBefore:!0,isDisplay:!r,setPassword:r,countryCode:a.countryCode,getPassword:!1,firstName:a.user.firstName,webSite:a.user.webSite,lastName:a.user.lastName,passwordAuthentication:null===a||void 0===a||null===(s=a.themeData)||void 0===s?void 0:s.passwordAuthentication,registerExtraFields:null===a||void 0===a||null===(o=a.themeData)||void 0===o?void 0:o.registerExtraFields,extraFields:{},internationalCodeClass:(0,c.zu)(a.user.internationalCode)?"true":null,internationalCode:a.user.internationalCode,email:"",goToProfile:!1,goToSiteBuilder:!1,loginMethod:"sms",token:a.user.token,CameFromPost:a.CameFromPost,goToProduct:a.goToProduct,goToCheckout:a.goToCheckout,goToChat:a.goToChat,timer:x},window.scrollTo(0,0),this.captchaAction=this.captchaAction.bind(this)}fd(e){(0,c.SR)(e)}fc(e){(0,c.lY)(e)}componentDidUpdate(e,t){}checkResponse(e){this.setState({loginMethod:e})}componentDidMount(){(0,c.zK)().then((e=>{var t;this.setState({sessionId:null===e||void 0===e||null===(t=e.sessionInfo)||void 0===t?void 0:t.sessionID})}))}componentWillUnmount(){clearInterval(this.myInterval)}captchaValue(e){}captchaAction(e){!0===e&&this.setState({captcha:!0})}render(){const{isDisplay:e,goToProfile:t,goToSiteBuilder:s,token:a,firstName:r,lastName:l,CameFromPost:n,goToProduct:d,setPassword:m,registerExtraFields:u,getPassword:v,internationalCode:g,enterActivationCodeMode:f,internationalCodeClass:N,userWasInDbBefore:b,goToCheckout:j,webSite:C,goToChat:y,loginMethod:w,extraFields:S,timer:P,passwordAuthentication:k}=this.state,{t:A,fromPage:F}=this.props;return a&&d?(this.fc(!1),(0,p.jsx)(i.Fg,{to:"/submit-order/"+d})):a&&j&&r&&l&&!m?((0,c.TJ)({goToCheckout:!1}),(0,p.jsx)(i.Fg,{to:"/checkout/"})):a&&!j&&F&&!m?((0,c.TJ)({goToCheckout:!1}),(0,p.jsx)(i.Fg,{to:F+"/"})):a&&y?((0,c.TJ)({goToChat:!1}),(0,p.jsx)(i.Fg,{to:"/chat/"})):a&&n&&!m?(this.fd(!1),(0,p.jsx)(i.Fg,{to:"/add-new-post/publish"})):t?(0,p.jsx)(i.Fg,{to:"/profile"}):s?(0,p.jsx)(i.Fg,{to:"/webSiteBuilder"}):(0,p.jsxs)(o.NX,{className:"login-register-form-inside",flush:!0,children:[e&&(0,p.jsx)(o.WI,{className:"p-3",children:(0,p.jsx)(o.X2,{children:(0,p.jsx)(o.JX,{children:(0,p.jsxs)(o.l0,{onSubmit:this.handleRegister,children:[(0,p.jsx)(o.X2,{form:!0,children:(0,p.jsxs)(o.JX,{md:"12",className:"form-group ltr",children:[(0,p.jsx)("label",{htmlFor:"thepho",children:A("phone number")}),(0,p.jsxs)(o.BZ,{className:"mb-3",children:[(0,p.jsx)(o.wF,{type:"prepend",children:(0,p.jsx)(o.ih,{onChange:e=>this.setState({countryCode:e.target.value}),children:(0,p.jsx)("option",{value:"98",children:"+98"})})}),(0,p.jsx)(o.yt,{placeholder:"",id:"thepho",className:"iuygfghuji ltr",type:"tel",dir:"ltr",onChange:e=>this.setState({phoneNumber:e.target.value})})]})]})}),(0,p.jsx)(o.X2,{form:!0}),(0,p.jsx)(o.zx,{block:!0,type:"submit",className:"center",onClick:this.handleRegister,children:A("get enter code")})]})})})}),f&&(0,p.jsx)(o.WI,{className:"p-3",children:(0,p.jsx)(o.X2,{children:(0,p.jsx)(o.JX,{children:(0,p.jsxs)(o.l0,{onSubmit:this.handleActivation,children:[(0,p.jsx)(o.X2,{form:!0,children:(0,p.jsxs)(o.JX,{md:"12",className:"form-group",children:[(0,p.jsxs)("div",{className:"your-phone-number d-flex justify-content-sb",children:[(0,p.jsx)("div",{className:"flex-item ",children:A("your phone number")+":"}),(0,p.jsx)("div",{className:"flex-item ltr",children:"+"+this.state.countryCode+this.state.thePhoneNumber})]}),(0,p.jsx)("div",{className:"your-timer",children:(0,p.jsx)("div",{className:"flex-item ",children:Boolean(P)&&(0,p.jsxs)("div",{className:"flex-item-relative center ",children:[(0,p.jsx)(h.Z,{className:"red-progress",thickness:2,size:120,variant:"determinate",value:parseInt(100*P/x)}),(0,p.jsx)("div",{className:"flex-item-absolute ",children:P})]})})}),(0,p.jsx)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"start"},children:(0,p.jsx)("label",{style:{fontSize:12},htmlFor:"feEmailAddress",children:A("enter sent code")})}),(0,p.jsx)(o.BZ,{className:"mb-3",children:(0,p.jsx)(o.yt,{placeholder:"_ _ _ _ _ _",type:"number",className:"iuygfghuji ltr",dir:"ltr",onChange:e=>{this.setState({activationCode:e.target.value})}})})]})}),(0,p.jsx)(o.X2,{form:!0,children:(0,p.jsx)(o.JX,{md:"12",className:"form-group"})}),(0,p.jsx)(o.zx,{block:!0,type:"submit",className:"center",onClick:this.handleActivation,children:A("login")}),(0,p.jsx)(o.zx,{outline:!0,type:"button",className:"center btn-block outline the-less-important",onClick:this.handleWrongPhoneNumber,children:A("Wrong phone number?")}),Boolean(!P)&&(0,p.jsx)("div",{className:"flex-item-relative center ",children:(0,p.jsx)(o.zx,{outline:!0,type:"button",className:"center btn-block outline the-less-important the-no-border",onClick:e=>this.handleRegister(e),children:A("Send code again?")})})]})})})}),m&&(0,p.jsx)(o.WI,{className:"p-3",children:(0,p.jsx)(o.X2,{children:(0,p.jsx)(o.JX,{children:(0,p.jsxs)(o.l0,{onSubmit:this.savePasswordAndData,children:[(0,p.jsxs)(o.X2,{form:!0,children:[(0,p.jsxs)(o.JX,{md:"12",className:"form-group",children:[(0,p.jsx)("label",{htmlFor:"olfirstname",children:A("Your first name")}),(0,p.jsx)(o.BZ,{className:"mb-3",children:(0,p.jsx)(o.yt,{placeholder:A("First name (persian)"),type:"text",id:"olfirstname",dir:"rtl",value:r,onChange:e=>this.setState({firstName:e.target.value})})})]}),(0,p.jsxs)(o.JX,{md:"12",className:"form-group",children:[(0,p.jsx)("label",{htmlFor:"ollastname",children:A("Your last name")}),(0,p.jsx)(o.BZ,{className:"mb-3",children:(0,p.jsx)(o.yt,{placeholder:A("Last name (persian)"),type:"text",value:l,id:"ollastname",dir:"rtl",onChange:e=>this.setState({lastName:e.target.value})})})]}),!b&&(0,p.jsxs)(o.JX,{md:"12",className:"form-group",children:[(0,p.jsx)("label",{htmlFor:"ollastname",children:A("Your domain Name")}),(0,p.jsx)(o.BZ,{className:"mb-3",children:(0,p.jsx)(o.yt,{placeholder:A("Website"),type:"text",value:null===C||void 0===C?void 0:C.title,id:"ollastname",onChange:e=>this.setState({webSite:{title:e.target.value}})})})]}),u&&u.map((e=>"internationalCode"==(null===e||void 0===e?void 0:e.name)?(0,p.jsxs)(o.JX,{md:"12",className:"form-group "+N,children:[(0,p.jsx)("label",{htmlFor:"internationalCode",children:A("International Code")}),(0,p.jsx)(o.BZ,{className:"mb-3",children:(0,p.jsx)(o.yt,{className:"iuygfghuji ltr",placeholder:A("xxxxxxxxxx"),type:"number",value:g,id:"internationalCode",dir:"ltr",onChange:t=>{let s=S;s[null===e||void 0===e?void 0:e.name]=t.target.value,this.setState({internationalCode:t.target.value,internationalCodeClass:(0,c.zu)(t.target.value),extraFields:{...s}})}})})]}):(0,p.jsxs)(o.JX,{md:"12",className:"form-group",children:[(0,p.jsx)("label",{htmlFor:"ollastname",children:null===e||void 0===e?void 0:e.label}),(0,p.jsx)(o.BZ,{className:"mb-3",children:(0,p.jsx)(o.yt,{placeholder:null===e||void 0===e?void 0:e.label,type:"text",value:S[null===e||void 0===e?void 0:e.name],id:"ollastname",dir:"rtl",onChange:t=>{let s=S;s[null===e||void 0===e?void 0:e.name]=t.target.value,this.setState({extraFields:{...s}})}})})]}))),k&&(0,p.jsxs)(o.JX,{md:"12",className:"form-group",children:[(0,p.jsx)("label",{htmlFor:"oiuytpaswword",children:A("set new password")}),(0,p.jsx)(o.BZ,{className:"mb-3",children:(0,p.jsx)(o.yt,{placeholder:"******",type:"password",id:"oiuytpaswword",dir:"ltr",onChange:e=>this.setState({password:e.target.value})})})]})]}),(0,p.jsx)(o.X2,{form:!0,children:(0,p.jsx)(o.JX,{md:"12",className:"form-group"})}),(0,p.jsx)(o.zx,{type:"submit",className:"center btn-block",onClick:this.savePasswordAndData,children:A("Register")}),(0,p.jsx)(o.zx,{type:"submit",className:"center btn-block",onClick:c.RD,children:A("Logout")})]})})})}),v&&(0,p.jsx)(o.WI,{className:"p-3",children:(0,p.jsx)(o.X2,{children:(0,p.jsx)(o.JX,{children:(0,p.jsxs)(o.l0,{onSubmit:this.handlePassword,children:[(0,p.jsx)(o.X2,{form:!0,children:(0,p.jsxs)(o.JX,{md:"12",className:"form-group",children:[(0,p.jsx)("div",{className:"your-phone-number d-flex justify-content-sb",children:(0,p.jsx)("div",{className:"mb-2 flex-item",children:A("You registered before, please enter your password.")})}),(0,p.jsxs)("div",{className:"your-phone-number d-flex justify-content-sb",children:[(0,p.jsx)("div",{className:"flex-item ",children:A("your phone number")+":"}),(0,p.jsx)("div",{className:"flex-item ltr",children:"+"+this.state.countryCode+this.state.thePhoneNumber})]}),(0,p.jsx)("label",{htmlFor:"oiuytgpaswword",children:A("Enter password")}),(0,p.jsx)(o.BZ,{className:"mb-3",children:(0,p.jsx)(o.yt,{placeholder:"******",type:"password",id:"oiuytgpaswword",dir:"ltr",onChange:e=>this.setState({password:e.target.value})})})]})}),(0,p.jsx)(o.X2,{form:!0,children:(0,p.jsx)(o.JX,{md:"12",className:"form-group"})}),(0,p.jsx)(o.zx,{block:!0,type:"submit",className:"center",onClick:this.handlePassword,children:A("Login")}),(0,p.jsx)(o.zx,{type:"button",className:"center btn-block",onClick:this.handleForgotPass,children:A("Forgot Password")}),(0,p.jsx)(o.zx,{outline:!0,type:"button",className:"center btn-block outline the-less-important",onClick:this.handleWrongPhoneNumber,children:A("Wrong phone number?")})]})})})})]})}}const g=(0,a.Zh)()(v);function f(){const{t:e}=(0,a.$G)(),[t]=(0,r.lr)(),s=(0,i.UO)(),n=t.get("fromPage");return"goToCheckout"===s._state&&(0,c.TJ)({goToCheckout:!0}),"goToChat"===s._state&&(0,c.TJ)({goToChat:!0}),(0,p.jsxs)(o.W2,{fluid:!0,className:"main-content-container px-4",children:[(0,p.jsx)(o.X2,{noGutters:!0,className:"page-header py-4",children:(0,p.jsx)(l.Z,{sm:"12",title:e("login / register"),subtitle:e("user account"),className:"text-sm-left"})}),(0,p.jsx)("div",{className:"w-100 login-register-form-wrapper",children:(0,p.jsx)(o.JX,{lg:"4",className:"mx-auto mb-4",children:(0,p.jsx)(o.Zb,{children:(0,p.jsx)(g,{goToCheckout:"goToCheckout"===s._state,fromPage:n})})})})]})}}}]);